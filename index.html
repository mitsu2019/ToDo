<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U-ToDo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, onSnapshot, query, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let user = null;
        let todos = [];
        let masters = { requesters: [], depts: [] };
        let isEditing = false;
        let currentSort = { key: 'deadline', asc: true };
        
        // Firebaseé–¢é€£ã®å¤‰æ•°ã‚’ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã§å®£è¨€
        let app, auth, db;
        const appId = 'u-todo-app-default';

        // ---------------------------------------------------------
        // 1. UIæ“ä½œé–¢æ•°
        // ---------------------------------------------------------

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        window.switchTab = (tabId) => {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(el => {
                el.classList.remove('tab-active', 'text-blue-600');
                el.classList.add('text-slate-500');
            });
            const targetContent = document.getElementById(`content-${tabId}`);
            if (targetContent) targetContent.classList.remove('hidden');
            
            const activeBtn = document.getElementById(`tab-${tabId}`);
            if (activeBtn) {
                activeBtn.classList.add('tab-active', 'text-blue-600');
            }
            if (tabId === 'input') updateSelects();
        };

        // ãƒ¢ãƒ¼ãƒ€ãƒ«é–‹é–‰
        window.toggleMasterModal = (show) => {
            const modal = document.getElementById('master-modal');
            if (!modal) return;
            modal.classList.toggle('hidden', !show);
            if (!show) updateSelects();
        };

        // ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤º
        window.showToast = (message, icon = 'âœ…') => {
            const toast = document.getElementById('toast');
            if (!toast) return;
            document.getElementById('toast-icon').innerText = icon;
            document.getElementById('toast-message').innerText = message;
            toast.classList.remove('translate-y-24', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');
            setTimeout(() => {
                toast.classList.add('translate-y-24', 'opacity-0');
                toast.classList.remove('translate-y-0', 'opacity-100');
            }, 3000);
        };

        // ç·¨é›†ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        window.cancelEdit = () => {
            isEditing = false;
            document.getElementById('form-title').innerText = 'æ–°è¦ã‚¿ã‚¹ã‚¯ç™»éŒ²';
            document.getElementById('submit-btn').innerText = 'ToDoã‚’ç™»éŒ²';
            document.getElementById('cancel-edit-btn').classList.add('hidden');
            const form = document.getElementById('todo-form');
            if(form) form.reset();
            document.getElementById('f-id').value = '';
            const dateInput = document.getElementById('f-date');
            if (dateInput) dateInput.valueAsDate = new Date();
        };

        // ToDoç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã¸
        window.editTodo = (id) => {
            const todo = todos.find(t => t.id == id);
            if (!todo) return;
            isEditing = true;
            document.getElementById('form-title').innerText = 'ToDoã®å†…å®¹ã‚’ç·¨é›†';
            document.getElementById('submit-btn').innerText = 'å¤‰æ›´ã‚’ä¿å­˜ã™ã‚‹';
            document.getElementById('cancel-edit-btn').classList.remove('hidden');
            
            document.getElementById('f-id').value = id;
            if(todo.requester) document.getElementById('f-requester').value = todo.requester;
            if(todo.dept) document.getElementById('f-dept').value = todo.dept;
            if(todo.status) document.getElementById('f-status').value = todo.status;
            if(todo.date) document.getElementById('f-date').value = todo.date;
            if(todo.deadline) document.getElementById('f-deadline').value = todo.deadline;
            if(todo.content) document.getElementById('f-content').value = todo.content;
            if(todo.report) document.getElementById('f-report').value = todo.report;
            
            switchTab('input');
        };

        // ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
        window.sortTable = (key) => {
            if (currentSort.key === key) currentSort.asc = !currentSort.asc;
            else { currentSort.key = key; currentSort.asc = true; }
            renderTodos();
        };

        // ---------------------------------------------------------
        // 2. ãƒ‡ãƒ¼ã‚¿æ“ä½œãƒ­ã‚¸ãƒƒã‚¯
        // ---------------------------------------------------------

        function updateSelects() {
            const rSelect = document.getElementById('f-requester');
            const dSelect = document.getElementById('f-dept');
            if (!rSelect || !dSelect) return;

            const currentR = rSelect.value;
            const currentD = dSelect.value;

            const safeRequesters = Array.isArray(masters.requesters) ? masters.requesters : [];
            const safeDepts = Array.isArray(masters.depts) ? masters.depts : [];

            rSelect.innerHTML = '<option value="">é¸æŠã—ã¦ãã ã•ã„</option>' + 
                safeRequesters.map(v => `<option value="${v}">${v}</option>`).join('');
            dSelect.innerHTML = '<option value="">é¸æŠã—ã¦ãã ã•ã„</option>' + 
                safeDepts.map(v => `<option value="${v}">${v}</option>`).join('');
            
            if(currentR) rSelect.value = currentR;
            if(currentD) dSelect.value = currentD;
        }

        function renderMasters() {
            const reqList = document.getElementById('list-requesters');
            const deptList = document.getElementById('list-depts');
            if (!reqList || !deptList) return;

            const safeRequesters = Array.isArray(masters.requesters) ? masters.requesters : [];
            const safeDepts = Array.isArray(masters.depts) ? masters.depts : [];

            reqList.innerHTML = safeRequesters.map((v, i) => `
                <li class="flex justify-between items-center bg-white p-3 rounded-lg text-sm border border-slate-200 shadow-sm">
                    <span class="font-medium text-slate-700">${v}</span>
                    <button onclick="removeMaster('requesters', ${i})" class="text-slate-300 hover:text-red-500 px-2">âœ•</button>
                </li>
            `).join('');
            deptList.innerHTML = safeDepts.map((v, i) => `
                <li class="flex justify-between items-center bg-white p-3 rounded-lg text-sm border border-slate-200 shadow-sm">
                    <span class="font-medium text-slate-700">${v}</span>
                    <button onclick="removeMaster('depts', ${i})" class="text-slate-300 hover:text-red-500 px-2">âœ•</button>
                </li>
            `).join('');
        }

        function renderTodos() {
            const body = document.getElementById('todo-table-body');
            const noData = document.getElementById('no-data');
            if (!body || !noData) return;

            if (todos.length === 0) {
                body.innerHTML = '';
                noData.classList.remove('hidden');
                return;
            }
            noData.classList.add('hidden');
            
            const sortedTodos = [...todos].sort((a, b) => {
                let valA = a[currentSort.key] || '';
                let valB = b[currentSort.key] || '';
                if (currentSort.key === 'date' || currentSort.key === 'deadline') {
                    valA = new Date(valA); valB = new Date(valB);
                }
                return currentSort.asc ? (valA > valB ? 1 : -1) : (valA < valB ? 1 : -1);
            });

            body.innerHTML = sortedTodos.map(todo => `
                <tr class="hover:bg-slate-50 transition-colors border-b border-slate-100 group clickable" onclick="editTodo('${todo.id}')">
                    <td class="p-4 font-medium text-slate-800">${todo.requester || '-'}</td>
                    <td class="p-4 text-slate-600">${todo.dept || '-'}</td>
                    <td class="p-4 text-slate-500">${todo.date || '-'}</td>
                    <td class="p-4 font-mono ${isOverdue(todo.deadline, todo.status) ? 'text-red-500 font-bold' : 'text-slate-600'}">${todo.deadline || '-'}</td>
                    <td class="p-4 max-w-xs">
                        <div class="truncate text-slate-800 font-medium" title="${todo.content}">${todo.content || ''}</div>
                        ${todo.report ? `<div class="truncate text-xs text-blue-600 mt-1" title="${todo.report}">ğŸ“ ${todo.report}</div>` : ''}
                    </td>
                    <td class="p-4">
                        <span class="px-3 py-1 rounded-full text-[11px] font-bold uppercase tracking-wider ${getStatusClass(todo.status)}">
                            ${todo.status || 'æœªé–‹å§‹'}
                        </span>
                    </td>
                    <td class="p-4 text-center">
                        <button onclick="event.stopPropagation(); deleteTodoFromCloud('${todo.id}')" class="text-slate-300 hover:text-red-500 transition-colors p-2">
                            ğŸ—‘ï¸
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function isOverdue(deadline, status) {
            if (status === 'å®Œäº†' || !deadline) return false;
            return new Date(deadline) < new Date().setHours(0,0,0,0);
        }

        function getStatusClass(status) {
            switch(status) {
                case 'æœªé–‹å§‹': return 'bg-slate-100 text-slate-600 border border-slate-200';
                case 'é€²æ—ä¸­': return 'bg-blue-50 text-blue-700 border border-blue-100';
                case 'å®Œäº†': return 'bg-emerald-50 text-emerald-700 border border-emerald-100';
                default: return 'bg-gray-100';
            }
        }

        // ---------------------------------------------------------
        // 3. FirebaseåˆæœŸåŒ– & ã‚¯ãƒ©ã‚¦ãƒ‰æ“ä½œ
        // ---------------------------------------------------------
        
        async function initFirebase() {
            try {
                const firebaseConfig = {
                    apiKey: "AIzaSyBW0TGJ0TAC29vqDta7j0tJcdwZGMlX3sU",
                    authDomain: "u-todo-eca0c.firebaseapp.com",
                    projectId: "u-todo-eca0c",
                    storageBucket: "u-todo-eca0c.firebasestorage.app",
                    messagingSenderId: "712192496282",
                    appId: "1:712192496282:web:5f7eeaa7453450da18c523",
                    measurementId: "G-KX7XNXKPK2"
                };
                
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                onAuthStateChanged(auth, (u) => {
                    user = u;
                    if (user) setupDataListeners();
                });

                await signInAnonymously(auth);

            } catch (error) {
                console.error("Firebase Initialization Error:", error);
            }
        }

        function setupDataListeners() {
            if (!user || !db) return;

            const masterDocPath = ['artifacts', appId, 'public', 'data', 'settings', 'masters'];
            const masterDocRef = doc(db, ...masterDocPath);
            
            onSnapshot(masterDocRef, (docSnap) => {
                if (docSnap.exists()) {
                    masters = docSnap.data();
                }
                renderMasters();
                updateSelects();
            });

            const todoCol = collection(db, 'artifacts', appId, 'public', 'data', 'todos');
            onSnapshot(todoCol, (querySnapshot) => {
                todos = [];
                querySnapshot.forEach((doc) => {
                    todos.push({ id: doc.id, ...doc.data() });
                });
                renderTodos();
            });
        }

        window.saveTodo = async (todoData, existingId = null) => {
            if (!user || !db) return;
            const todoCol = collection(db, 'artifacts', appId, 'public', 'data', 'todos');
            try {
                if (existingId) {
                    await updateDoc(doc(todoCol, existingId), todoData);
                    window.showToast('ToDoã‚’æ›´æ–°ã—ã¾ã—ãŸ');
                } else {
                    const newDocRef = doc(todoCol);
                    await setDoc(newDocRef, {
                        ...todoData,
                        createdAt: new Date().toISOString()
                    });
                    window.showToast('ToDoã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
                }
            } catch (error) { window.showToast("ä¿å­˜å¤±æ•—", "âŒ"); }
        };

        window.deleteTodoFromCloud = async (id) => {
            if (!user || !db || !confirm('ã“ã®ToDoã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) return;
            try {
                await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'todos', id));
                window.showToast('å‰Šé™¤ã—ã¾ã—ãŸ', 'ğŸ—‘ï¸');
            } catch (error) { window.showToast("å‰Šé™¤å¤±æ•—", "âŒ"); }
        };

        window.saveMastersToCloud = async (newMasters) => {
            if (!user || !db) return;
            try {
                const masterDocRef = doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'masters');
                await setDoc(masterDocRef, newMasters);
            } catch (error) { }
        };

        window.addMaster = (type) => {
            const inputId = type === 'requesters' ? 'master-requester-input' : 'master-dept-input';
            const input = document.getElementById(inputId);
            const value = input?.value.trim();
            if (!value) return;
            if (!masters[type]) masters[type] = [];
            if (masters[type].includes(value)) return window.showToast("ç™»éŒ²æ¸ˆã¿ã§ã™", "âš ï¸");
            masters[type].push(value);
            saveMastersToCloud(masters);
            input.value = '';
            renderMasters();
            window.showToast("ç™»éŒ²ã—ã¾ã—ãŸ");
        };

        window.removeMaster = (type, index) => {
            if (masters[type]) {
                masters[type].splice(index, 1);
                saveMastersToCloud(masters);
                renderMasters();
            }
        };

        window.submitTodoForm = (e) => {
            e.preventDefault();
            const idField = document.getElementById('f-id').value;
            const data = {
                requester: document.getElementById('f-requester').value,
                dept: document.getElementById('f-dept').value,
                status: document.getElementById('f-status').value,
                date: document.getElementById('f-date').value,
                deadline: document.getElementById('f-deadline').value,
                content: document.getElementById('f-content').value,
                report: document.getElementById('f-report').value,
            };
            window.saveTodo(data, idField || null);
            window.cancelEdit();
            window.switchTab('manage');
        };

        window.addEventListener('load', () => {
            const dateInput = document.getElementById('f-date');
            if (dateInput) dateInput.valueAsDate = new Date();
            // â˜…ãƒã‚¤ãƒ³ãƒˆï¼šèµ·å‹•æ™‚ã«ã€Œç®¡ç†ä¸€è¦§ã€ã‚’è¡¨ç¤ºã™ã‚‹
            window.switchTab('manage'); 
            initFirebase();
        });

    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap');
        body { font-family: 'Inter', 'Noto Sans JP', sans-serif; background-color: #f8fafc; }
        .tab-active { border-bottom: 2px solid #3b82f6; color: #3b82f6; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .modal-animate-in { animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        tr.clickable:hover { cursor: pointer; background-color: #f1f5f9; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <header class="mb-8 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
            <div>
                <h1 class="text-3xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="text-blue-600">ğŸ“‹</span> U-ToDo
                </h1>
                <p class="text-slate-500 mt-2">ã‚¯ãƒ©ã‚¦ãƒ‰ä¿å­˜å¯¾å¿œãƒ»ãƒãƒ¼ãƒ å…±æœ‰ã‚¿ã‚¹ã‚¯ç®¡ç†</p>
            </div>
            <button onclick="toggleMasterModal(true)" class="bg-slate-800 hover:bg-slate-700 text-white px-5 py-2.5 rounded-lg transition-all flex items-center gap-2 shadow-lg">
                âš™ï¸ ãƒã‚¹ã‚¿ãƒ¼ç™»éŒ²
            </button>
        </header>

        <nav class="flex space-x-8 border-b border-slate-200 mb-8 overflow-x-auto">
            <button onclick="switchTab('manage')" id="tab-manage" class="tab-btn py-4 px-1 text-sm font-medium transition-all">ToDoç®¡ç†ä¸€è¦§</button>
            <button onclick="switchTab('input')" id="tab-input" class="tab-btn py-4 px-1 text-sm font-medium transition-all">ToDoå…¥åŠ›</button>
        </nav>

        <main>
            <section id="content-manage" class="tab-content hidden">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                        <h2 class="text-xl font-semibold text-slate-700">ToDoãƒªã‚¹ãƒˆä¸€è¦§</h2>
                        <div class="text-xs text-slate-400 italic">â€» è¡Œã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ç·¨é›†ã§ãã¾ã™</div>
                    </div>
                    <div class="overflow-x-auto custom-scrollbar">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-slate-50 text-slate-500 text-xs uppercase">
                                    <th class="p-4 border-b border-slate-100 font-semibold cursor-pointer" onclick="sortTable('requester')">ä¾é ¼è€… â‡…</th>
                                    <th class="p-4 border-b border-slate-100 font-semibold cursor-pointer" onclick="sortTable('dept')">å¯¾å¿œéƒ¨ç½² â‡…</th>
                                    <th class="p-4 border-b border-slate-100 font-semibold cursor-pointer" onclick="sortTable('date')">æ—¥ä»˜ â‡…</th>
                                    <th class="p-4 border-b border-slate-100 font-semibold cursor-pointer" onclick="sortTable('deadline')">æœŸé™ â‡…</th>
                                    <th class="p-4 border-b border-slate-100 font-semibold">ã‚¿ã‚¹ã‚¯å†…å®¹ / çŠ¶æ³</th>
                                    <th class="p-4 border-b border-slate-100 font-semibold cursor-pointer" onclick="sortTable('status')">çŠ¶æ…‹ â‡…</th>
                                    <th class="p-4 border-b border-slate-100 font-semibold text-center">æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="todo-table-body" class="text-sm text-slate-700"></tbody>
                        </table>
                    </div>
                    <div id="no-data" class="hidden text-center py-12"><p class="text-slate-400 italic">ç™»éŒ²ã•ã‚ŒãŸToDoã¯ã‚ã‚Šã¾ã›ã‚“</p></div>
                </div>
            </section>

            <section id="content-input" class="tab-content hidden">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="form-title" class="text-xl font-semibold text-slate-700">æ–°è¦ã‚¿ã‚¹ã‚¯ç™»éŒ²</h2>
                        <button id="cancel-edit-btn" onclick="cancelEdit()" class="hidden text-sm text-red-500 hover:text-red-700 font-medium">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    </div>
                    <form id="todo-form" onsubmit="submitTodoForm(event)" class="space-y-4">
                        <input type="hidden" id="f-id">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div><label class="block text-sm font-medium text-slate-600 mb-1">ä¾é ¼è€…</label><select id="f-requester" class="w-full border border-slate-300 rounded-lg px-3 py-2 outline-none" required></select></div>
                            <div><label class="block text-sm font-medium text-slate-600 mb-1">å¯¾å¿œéƒ¨ç½²</label><select id="f-dept" class="w-full border border-slate-300 rounded-lg px-3 py-2 outline-none" required></select></div>
                            <div><label class="block text-sm font-medium text-slate-600 mb-1">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label><select id="f-status" class="w-full border border-slate-300 rounded-lg px-3 py-2 outline-none"><option value="æœªé–‹å§‹">æœªé–‹å§‹</option><option value="é€²æ—ä¸­">é€²æ—ä¸­</option><option value="å®Œäº†">å®Œäº†</option></select></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div><label class="block text-sm font-medium text-slate-600 mb-1">æ—¥ä»˜</label><input type="date" id="f-date" class="w-full border border-slate-300 rounded-lg px-3 py-2 outline-none" required></div>
                            <div><label class="block text-sm font-medium text-slate-600 mb-1">ç· åˆ‡æœŸé™</label><input type="date" id="f-deadline" class="w-full border border-slate-300 rounded-lg px-3 py-2 outline-none" required></div>
                        </div>
                        <div><label class="block text-sm font-medium text-slate-600 mb-1">ã‚¿ã‚¹ã‚¯å†…å®¹</label><textarea id="f-content" rows="3" class="w-full border border-slate-300 rounded-lg px-3 py-2 outline-none" required></textarea></div>
                        <div><label class="block text-sm font-medium text-slate-600 mb-1">çŠ¶æ³å ±å‘Š</label><textarea id="f-report" rows="3" class="w-full border border-slate-300 rounded-lg px-3 py-2 outline-none bg-slate-50"></textarea></div>
                        <div class="flex justify-end pt-4"><button type="submit" id="submit-btn" class="bg-blue-600 text-white font-bold py-2 px-8 rounded-lg shadow-md">ToDoã‚’ç™»éŒ²</button></div>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <div id="master-modal" class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-50 flex items-center justify-center hidden">
        <div class="bg-white w-full max-w-4xl h-[90vh] md:h-auto rounded-2xl shadow-2xl flex flex-col modal-animate-in overflow-hidden">
            <div class="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                <h2 class="text-xl font-bold text-slate-800">âš™ï¸ ãƒã‚¹ã‚¿ãƒ¼ç™»éŒ²ç®¡ç†</h2>
                <button onclick="toggleMasterModal(false)" class="text-slate-400 text-2xl">âœ•</button>
            </div>
            <div class="p-6 overflow-y-auto flex-1">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <h3 class="font-bold text-slate-700 border-l-4 border-blue-500 pl-3">ä¾é ¼è€…ã®è¿½åŠ </h3>
                        <div class="flex gap-2"><input type="text" id="master-requester-input" class="flex-1 border border-slate-300 rounded-lg px-3 py-2 outline-none"><button onclick="addMaster('requesters')" class="bg-blue-600 text-white px-4 py-2 rounded-lg">è¿½åŠ </button></div>
                        <ul id="list-requesters" class="space-y-2 pr-2"></ul>
                    </div>
                    <div class="space-y-4">
                        <h3 class="font-bold text-slate-700 border-l-4 border-blue-500 pl-3">å¯¾å¿œéƒ¨ç½²ã®è¿½åŠ </h3>
                        <div class="flex gap-2"><input type="text" id="master-dept-input" class="flex-1 border border-slate-300 rounded-lg px-3 py-2 outline-none"><button onclick="addMaster('depts')" class="bg-blue-600 text-white px-4 py-2 rounded-lg">è¿½åŠ </button></div>
                        <ul id="list-depts" class="space-y-2 pr-2"></ul>
                    </div>
                </div>
            </div>
            <div class="p-6 border-t border-slate-100 flex justify-end">
                <button onclick="toggleMasterModal(false)" class="bg-slate-800 text-white px-8 py-2 rounded-lg">é–‰ã˜ã‚‹</button>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed bottom-8 right-8 bg-slate-800 text-white px-6 py-3 rounded-xl shadow-2xl transition-all duration-300 transform translate-y-24 opacity-0 flex items-center gap-2 z-[100]">
        <span id="toast-icon">âœ…</span><span id="toast-message">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</span>
    </div>
</body>
</html>
